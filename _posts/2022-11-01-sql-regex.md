---
title: "[SQL] 정규 표현식"
categories:
  - SQL
tags:
  - SQL
  - Regex
  - 정규 표현식 
toc: true
toc_sticky: true
toc_label: "목차"
---

# 개요
---
정규 표현식은 문자열의 규칙을 표현하는 검색 패턴으로 주로 문자열 검색과 치환에 사용된다.

# POSIX 연산자
---
정규 표현식의 POSIX 연산자(POSIX operator)를 살펴보자.

## . (dot)
.은 모든 문자와 일치(newline 제외)한 것을 찾을 때 사용한다.

### 예제
---

- 쿼리
  
```sql
SELECT REGEXP_SUBSTR('aab', 'a.b') AS C1
     , REGEXP_SUBSTR('abb', 'a.b') AS C2
     , REGEXP_SUBSTR('acb', 'a.b') AS C3
     , REGEXP_SUBSTR('adc', 'a.b') AS C4
  FROM DUAL;
```

- 결과

![. (dot) 예제](/blog/assets/img/posts/20221101/query-example.png ". (dot) 예제"){: width="100%"}

## | (or)
|는 대체 문자를 구분한다.

### 예제
---

- 쿼리
  
```sql
SELECT REGEXP_SUBSTR('a', 'a|b') AS C1
     , REGEXP_SUBSTR('b', 'a|b') AS C2
     , REGEXP_SUBSTR('c', 'a|b') AS C3
     , REGEXP_SUBSTR('ab', 'ab|cd') AS C4
     , REGEXP_SUBSTR('cd', 'ab|cd') AS C5
     , REGEXP_SUBSTR('bc', 'ab|cd') AS C6
     , REGEXP_SUBSTR('aa', 'a|aa') AS C7
     , REGEXP_SUBSTR('aa', 'aa|a') AS C8
  FROM DUAL;
```

- 결과

![| (or) 예제](/blog/assets/img/posts/20221101/query-example2.png "| (or) 예제"){: width="100%"}

## \ (backslash)
\는 다음 문자를 일반 문자로 취급한다.

### 예제
---

- 쿼리
  
```sql
SELECT REGEXP_SUBSTR('a|b', 'a|b') AS C1
     , REGEXP_SUBSTR('a|b', 'a\|b') AS C2
  FROM DUAL;
```

- 결과

![\ (backslash) 예제](/blog/assets/img/posts/20221101/query-example3.png "\ (backslash) 예제"){: width="100%"}

## ^ (carrot)
^는 검색 패턴의 문자열 시작점을 표현할 때 사용한다.

### 예제
---

- 쿼리
  
```sql
SELECT REGEXP_SUBSTR('ab' || CHR(10) || 'cd', '^.', 1, 1) AS C1
     , REGEXP_SUBSTR('ab' || CHR(10) || 'cd', '^.', 1, 2) AS C2
  FROM DUAL;
```

- 결과

![^ (carrot) 예제](/blog/assets/img/posts/20221101/query-example4.png "^ (carrot) 예제"){: width="100%"}

## $ (dollar)
$는 검색 패턴의 문자열 끝을 표현할 때 사용한다.

### 예제
---

- 쿼리
  
```sql
SELECT REGEXP_SUBSTR('ab' || CHR(10) || 'cd', '.$', 1, 1) AS C3
     , REGEXP_SUBSTR('ab' || CHR(10) || 'cd', '.$', 1, 2) AS C4
  FROM DUAL;
```

- 결과

![$ (dollar) 예제](/blog/assets/img/posts/20221101/query-example5.png "$ (dollar) 예제"){: width="100%"}

## 수량사
수량사는 선행 표현식의 일치 횟수를 지정한다. 패턴을 최대로 일치시키는 탐욕적 방식으로 동작한다. 종류는 다음과 같으며, 예제는 생략하겠다.
- ?
  >0회 또는 1회 일치
- *
  >0회 또는 그 이상의 횟수로 일치
- +
  >1회 또는 그 이상의 횟수로 일치
- {m} 
  >m회 일치
- {m,}
  >최소 m회 일치
- {,m}
  >최대 m회 일치
- {m,n}
  >최소 m회, 최대 n회 일치

## \n
\n은 n번째 서브 표현식과 일치, n은 1에서 9 사이의 정수

### 예제
---

- 쿼리
  
```sql
SELECT REGEXP_SUBSTR('abxab', '(ab|cd)x\1') AS C1
     , REGEXP_SUBSTR('cdxcd', '(ab|cd)x\1') AS C2
     , REGEXP_SUBSTR('abxef', '(ab|cd)x\1') AS C3
     , REGEXP_SUBSTR('ababab', '(.*)\1+') AS C4
     , REGEXP_SUBSTR('abcabc', '(.*)\1+') AS C5
     , REGEXP_SUBSTR('abcabd', '(.*)\1+') AS C6
  FROM DUAL;
```

- 결과

![\n 예제](/blog/assets/img/posts/20221101/query-example6.png "\n 예제"){: width="100%"}

## 문자리스트
문자 리스트는 문자를 대괄호로 묶은 표현식이다. 문자 리스트 중 한 문자만 일치하면 패턴이 일치한 것으로 처리된다. 문자 리스트에서 하이픈은 범위 연산자로 동작한다. 종류는 다음과 같으며 예제는 생략하겠다.

- [char...]
  >문자 리스트 중 한 문자와 일치
- [^char...]
  >문자 리스트에 포함되지 않은 한 문자와 일치
- [:digit]
  >숫자
---

읽어주셔서 감사합니다. 😊 

__Reference__  
SQL 전문가 가이드 - Kdata 한국데이터산업진흥원  